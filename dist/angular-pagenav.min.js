/**
 * angular-pagenav
 * @version v0.0.5 - 2015-04-15
 * @link http://html5beta.com/apps/angular-pagenav.html
 * @author ZHAO Xudong (zxdong@gmail.com)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(){angular.module("zPagenav",[]).directive("pagenav",["$compile",function(a){return{restrict:"A",scope:{page:"=",pageSize:"=",total:"=",options:"="},link:function(e,n){function t(a){var e,n,t={pageSize:a.pageSize||10,maxLinkShow:a.maxLinkShow||5,itemTotal:a.itemTotal||0,page:a.page||1,lang:a.lang||{page:"page",afterCurrentPage:", ",intotal:"in total",Prev:"Prev",Next:"Next",more:"..."},url:a.url||"javascript:;",pageParam:a.pageParam||"p",noFirstPageParam:a.noFirstPageParam||!1,ngClick:!0},r="",i=[],p=t.pageSize,s=t.page,l=t.itemTotal,g=t.maxLinkShow,c=l%p,u=Math.floor(l/p),o=c?u+1:u;if(s=s>o?o:s,n=0>=l?0:o>s?p:c?c:p,o>0){if(r='<span class="pagenav-wrapper'+(1===o?" only-one-page":"")+'"><span class="pagenav-desc">'+t.lang.page+'<span class="pagenav-current">'+s+'</span><span class="pagenav-acp">'+t.lang.afterCurrentPage+'</span><span class="pagenav-total">'+o+"</span> "+t.lang.intotal+'</span><span class="pagenav-units">',g>=o)for(e=1;o>=e;e++){var v,x,k;s==e?(v="pagenav-current-link pagenav-link",x=!0):(v="pagenav-link",x=!1),k={text:e,index:e,isCurrent:x,cls:v},i.push(k)}else if(o>g){var d=g-3;(s>=o-1||2>=s)&&d++;var m,f=Math.floor(d/2),h=d-f,C=s-1,P=o-s;s-1>f&&i.push({text:t.lang.Prev,index:s-1,isCurrent:!1,cls:"pagenav-link pagenav-link-prev"}),h>=P?(m=d-P,i.push({text:1,index:1,isCurrent:!1,cls:"pagenav-link"})):C>f?(m=f,i.push({text:1,index:1,isCurrent:!1,cls:"pagenav-link"})):m=C;var S=d-m;for(e=0;m>e;e++){var k={text:s-m+e,index:s-m+e,isCurrent:!1,cls:"pagenav-link"};i.push(k)}for(i.push({text:s,index:s,isCurrent:!0,cls:"pagenav-link pagenav-current-link"}),e=1;S>=e;e++){var k={text:s+e,index:s+e,isCurrent:!1,cls:"pagenav-link"};i.push(k)}P>S&&i.push({text:o,index:o,isCurrent:s==o?!0:!1,cls:s==o?"pagenav-link pagenav-current-link":"pagenav-link"}),P>h&&i.push({text:t.lang.Next,index:s+1,isCurrent:!1,cls:"pagenav-link pagenav-link-next"})}}else r="";for(var w,z=i.length,T=0,F="",L=!1,N=/javascript\:/.test(t.url),$=/\?|#/.test(t.url),j="";z>T;T++)w=i[T],j=N?t.url:t.url+(t.noFirstPageParam&&1===w.index?"":($?"&":"?")+t.pageParam+"="+w.index),T>0&&(L=i[T-1]),F=(w.isCurrent?"<span ":'<a href="'+j+'" ')+'data-page="'+w.index+'" '+(!w.isCurrent&&t.ngClick?'ng-click="click('+w.index+')" ':"")+'class="page-'+w.index+" "+w.cls+'">'+w.text+"</"+(w.isCurrent?"span>":"a>"),L&&L.index<w.index-1&&(r+='<span class="pagenav-more">'+t.lang.more+"</span>"),r+=F;return r+=r?"</span></span>":""}e.$watch(function(){return{page:e.page,pageSize:e.pageSize,itemTotal:e.total}},function(r){n.html(t(angular.extend({},e.options,r))),a(n.contents())(e.$new())},!0),e.click=function(a){e.page=a}}}}])}(window,document);